## 结构

```
.
├── ThreadPool.h      // 线程池类声明
├── ThreadPool.cpp    // 线程池实现
├── main.cpp          // 示例：提交任务并等待完成
└── Makefile          // Linux 下的构建脚本
```

## 线程池原理

线程池的核心思想是：

1. **预先创建固定数量的工作线程**
2. 所有任务被放入一个**共享任务队列**
3. 工作线程：

   * 没任务时休眠（不占 CPU）
   * 有任务时被唤醒并执行
4. 主线程可以等待：

   * 任务队列为空
   * 且没有线程正在执行任务

本实现中使用了两个条件变量：

* `cv_task`：用于通知 worker 有新任务
* `cv_done`：用于通知所有任务已经执行完成

---

## 主要类说明

### ThreadPool

对外提供三个核心接口：

* `ThreadPool(size_t n)`

  * 创建包含 `n` 个 worker 线程的线程池
* `submit(std::function<void()>)`

  * 向线程池提交一个任务
* `wait_all()`

  * 阻塞等待，直到所有任务执行完成

线程池在析构时会**优雅退出**：

* 不再接受新任务
* 执行完队列中已有任务
* 等待所有 worker 线程退出

---

## 示例程序说明（main.cpp）

`main.cpp` 中做了以下事情：

1. 创建一个包含 3 个线程的线程池
2. 提交 10 个打印任务
3. 等待所有任务完成
4. 主线程退出

每个任务会打印：

* 任务编号
* 实际执行该任务的线程 ID

从输出可以看到：

* 多个任务被不同线程并发执行
* 主线程在所有任务完成后才结束

### 编译

```bash
make build
```

生成可执行文件：

```text
./main
```

### 运行

```bash
make run
```

### 清理

```bash
make clean
```
